<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Scenarios :: Gloomhaven Enhanced</title>
    <meta name="generator" content="Antora 3.0.3">
    <link rel="stylesheet" href="../../_/css/site.css">
    <script>var uiRootPath = '../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../..">Gloomhaven Enhanced</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
          <div class="navbar-link">Community</div>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://discord.gg/SA9hHVNkMf">Discord</a>
            <a class="navbar-item" href="https://discord.gg/2kM4T6p">Custom Content Discord</a>
            <a class="navbar-item" href="https://www.reddit.com/r/GloomhavenTTSEnhanced/">Reddit</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="https://steamcommunity.com/sharedfiles/filedetails/?id=2402018642">Steam</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="custom" data-version="1.3">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html">Custom Content</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Introduction</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="scripts.html">How to use the scripts</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="documentation.html">How to use this documentation</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="contentbox.html">Content Box</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="class.html">Classes</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="condition.html">Conditions</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="enemy.html">Enemies</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="scenario.html">Scenarios</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="overlay.html">Overlays</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Common</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="common/formula.html">Formulas</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="common/action.html">Actions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="common/spawnable.html">Spawnable Element</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Migration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="migration/1.2.html">1.2</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Custom Content</span>
    <span class="version">1.3</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="index.html">Custom Content</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="index.html">1.3</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../dev/1.3/index.html">Development</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../dev/1.3/index.html">1.3</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../mod/1.3/index.html">Gloomhaven Enhanced</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../mod/1.3/index.html">1.3</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Custom Content</a></li>
    <li><a href="scenario.html">Scenarios</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/gloomhaven-tts-enhanced/public-scripts/edit/main/docs/content/customContent/modules/ROOT/pages/scenario.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Scenarios</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>To start building a custom scenario use the <a href="https://steamcommunity.com/sharedfiles/filedetails/?id=2494451797">Scenario Builder</a> mod.
The mod itself contains the information of how to use the builder to generate a scenario.</p>
</div>
<div class="paragraph">
<p>However, the builder currently only supports a subset of features the scenario definition is able to provide.
E.g. it can&#8217;t set HP values for overlays, named enemies or loot effects from treasure chests.
To add those features to a scenario, you can edit the generated scenario definition from the Scenario Builder.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This section is currently not well documented.
A lot of features are missing&#8230;&#8203;
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_basics"><a class="anchor" href="#_basics"></a>Basics</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The scenario builder creates a token, that contains the scenario definition within its script.
To adjust the scenario definition, the script has to be changed accordingly.
The script of the tokens looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">Unresolved include directive in modules/ROOT/pages/scenario.adoc - include::example$scenario/monster/start.lua[]</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_general_scenario_definition_structure"><a class="anchor" href="#_general_scenario_definition_structure"></a>General scenario definition structure</h2>
<div class="sectionbody">
<details>
<summary class="title">Big example of all the different parts</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">{
  name = "Black Barrow",
  scenarioBook = {
    name = "Gloomhaven",
    page = 3,
  },
  scenarioConclusions = {
    {
      image = "http://cloud-3.steamusercontent.com/ugc/1752439086837779719/8C6A36C4FDB88BCB7B012F7121A2DB8E1876D0B3/",
      scale = { 1.50, 1.00, 1.50 },
      buttonLabel = "Reveal Conclusion (36)"
    },
  },
  gridType = ScenarioApi.GridType.Horizontal,
  doorTiles = {
    {
      name = "Stone Door Horizontal",
      tiles = {
        {
          rooms = { 2, 3 },
          position = { x = -1.75, y = 1.82, z = 6.06 },
          rotation = { x = 0, y = 180, z = 0 },
          tokens = { "1" },
        }
      }
    },
    {
      name = "Stone Door Vertical",
      tiles = {
        --
      }
    }
  },
  rooms = {
    [1] = {
      mapTiles = {
        {
          tile = "L1",
          position = { x = 0.9, y = -3.77, z = -3.03 },
          rotation = { x = 0, y = 180, z = 0 }
        }
      },
      scenarioSections = {
        {
          image = "http://cloud-3.steamusercontent.com/ugc/1752439086836487818/4256434230672E8FBFFA1CBE7C1A93984DF2EA95/",
          position = { -28.44, 1.75, 21.98 },
          scale = { 0.69, 1.00, 0.69 },
          hidden = true,
          buttonLabel = "Section 02",
        },
      },
      startTiles = {
        name = "Stone Corridor 1",
        tiles = {
          {
            position = { x = -0.43, y = 1.93, z = -5.30 },
            rotation = { x = 0, y = 0, z = 0 }
          },
        }
      },
      monsters = {
        {
          name = "Bandit Guard",
          tiles = {
            {
              numCharacters = {
                [2] = ScenarioApi.MonsterLevel.Elite,
                [3] = nil,
                [4] = nil
              },
              position = { x = 0.87, y = 2.06, z = -1.51 },
            },
          }
        }
      },
      overlayTiles = {
        {
          bag = ScenarioApi.OverlayType.Trap,
          type = {
            {
              name = "Spike Trap",
              tiles = {
                {
                  position = { x = -0.43, y = 1.93, z = 6.81 },
                  rotation = { x = 0, y = 180, z = 0 },
                },
              }
            }
          }
        },
      },
    },
    [2] = {
      -- another room
    }
  },
  monsterList = {
    "Bandit Archer",
    "Bandit Guard",
    "Living Bones"
  }
}</code></pre>
</div>
</div>
</div>
</details>
<div class="sect2">
<h3 id="_default_monster_settings"><a class="anchor" href="#_default_monster_settings"></a>Default monster settings</h3>
<div class="paragraph">
<p>It&#8217;s possible to define extra attributes, stats, immunities or their used ability deck for all monsters of a given type as part of the scenario definition.
It is possible to distinguish between normal and elite monsters as well.
The general structure looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">local scenario = {
  monsters = {
    -- the name of the monster as the key
    ["Bandit Guard"] = {
      all = {
        -- settings applied to all Bandit Guards
      },
      normal = {
        -- settings additionally applied to all normal Bandit Guards
      },
      elite = {
        -- settings additionally applied to all elite Bandit Guards
      }
    },
    -- another monster
    ["Bandit Archer"] = {
      -- same structure as above
    }
  }
  -- rest of scenario definiton
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The settings from <code>all</code> are applied to all monsters that are spawned for this type.
Settings in <code>normal</code>/<code>elite</code> then are additionally applied to monsters of the given difficulty.</p>
</div>
<div class="paragraph">
<p>All entries follow the same structure and look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">all = {
  -- The ability deck to use. If not use it will use the monsters default ability deck
  abilityDeck = "Archer",
  -- A modifier that should be applied to the current scenario level.
  -- This will make the monsters stronger/weaker. It can be a Formula.
  levelModifier = 1,
  -- The current HP value for the monster. If hpMax is not used, this is also the maximum HP value.
  -- It can be a Formula. Use the variable "H" to reference the default HP value for this monster.
  hp = { "+", "H", 3 },
  -- The maximum HP value for the monster.
  -- It can be a Formula. Use the variable "H" to reference the default HP value for this monster.
  hpMax = { "+", "H", 3 },
  -- Adjusted stats for the monster
  stats = {
    -- Adjusted immunities
    immunities = {
      -- Immunities that will be added to the monster.
      add = { "Stun", "Muddle", "Poison" },
      -- Immunities that will be removed from the monster.
      remove = { "Curse" },
    },
    attributes = {
      -- Attributes that will be added/overwritten to the monster.
      -- The format is the same as for general Stats.
      -- The values currently can not be Formula, only fixed values.
      add = {
        "Muddle",
        Pierce = 3,
        Retaliate = {
          value = 2,
          range = 2,
        },
      },
      -- Attributes that will be removed from the monster.
      remove = { "Shield", "Wound" },
    },
    attack = 10,
    range = 2,
    move = 10,
    -- The text that will show below the monster.
    text = "New Text",
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The same structure can be applied to an individual monster as well, e.g. to overwrite the stats of a single monster of a given type.
The following example demonstrates this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">local scenario = {
  monsters = {
    ["Bandit Guard"] = {
      all = {
        stats = {
          immunities = { add = { "Poison" } }, }
      },
      elite = {
        stats = {
          immunities = { add = { "Wound" } },
        },
        attributes = { add = { "Muddle" } },
      }
    }
  },
  rooms = {
    [1] = {
      monsters = {
        {
          name = "Bandit Guard",
          tiles = {
            {
              -- This Bandit Guard will get the Posion immunity from all
              numCharacters = { [2] = Scenario.MonsterLevel.Normal },
            },
            {
              -- This Bandit Guard will get the Wound immunity from elite
              -- and the Muddle attack effect from elite.
              -- The immunity from all is overwritten by the immunities from elite
              numCharacters = { [2] = Scenario.MonsterLevel.Elite },
            },
            {
              -- This Bandit Guard will get the Muddle attack from elite and a Stun immunity.
              -- The immunities from all and elite are overwritten by its own definition
              numCharacters = { [2] = Scenario.MonsterLevel.Elite },
              stats = {
                immunities = { add = { "Stun" } },
              },
            },
          }
        }
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
While it is possible to define the used ability deck on all levels presented above, it&#8217;s only useful to use it within the definition of <code>all</code>.
It&#8217;s not possible to have the same monster type with different ability decks, so the first monster that spawns defines the used ability deck for all monsters of that type.
And if the "Preload Enemies" option is used to prepare all monsters in a scenario at its start, the settings for those prepared monsters is only defined by <code>all</code> (as those don&#8217;t have a difficulty setting).
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>
